---
layout: base
title: Guide
---

<h2>Order by</h2>

<p>Factory : <span class="inline_code">DB::orderby()</span></p>

<p>Represents a comma separated list of SQL expressions, followed by an ordering specification : <span class="inline_code">("mytable"."mycolumn1" + "mytable"."mycolumn2" * 3) ASC, "mytable"."mycolumn3" DESC, ...</span></p>

<h3>Item class</h3>

<p>Item : <a class="external" href="https://github.com/rlm80/Glue/tree/master/classes/system/db/fragment/item/orderby.php"><span class="inline_code">Fragment_Item_Orderby</span></a></p>

<p>The item is a fragment-order pair. The order can be either <span class="inline_code">DB::ASC</span>, <span class="inline_code">DB::DESC</span> or null (which means it won't be specified in the compiled SQL string). It has 4 methods :</p>

<ul>
  <li><span class="inline_code">-&gt;ordered()</span> : fragment getter/setter,</li>
  <li><span class="inline_code">-&gt;order()</span> : order getter/setter,</li>
  <li><span class="inline_code">-&gt;asc()</span> : same as <span class="inline_code">-&gt;order(DB::ASC),</li>
  <li><span class="inline_code">-&gt;desc()</span> : same as <span class="inline_code">-&gt;order(DB::DESC).</li>
</ul>

<h3>Builder class</h3>

<p>Builder : <a class="external" href="https://github.com/rlm80/Glue/tree/master/classes/system/db/fragment/builder/orderby.php"><span class="inline_code">Fragment_Builder_Orderby</span></a></p>

<p>The builder has only one method (returns <span class="inline_code">$this</span>) : <span class="inline_code">-&gt;orderby()</span>. It adds a list of SQL expressions to the order by. It can take any number of parameters, each of them can be either :</p>

<ul>
  <li>a string of pseudo SQL,</li>
  <li>a fragment,</li>
  <li>an array (string of pseudo SQL, order),</li>
  <li>an array (fragment, order).</li>
</ul>

<h3>Examples</h3>

{% highlight php %}
<?php

  use Glue\DB\DB;

  // Create fragment :
  $f = db::orderby("(`column1` + `column2` * 5)")->orderby("`column2`", array("`column3`", db::DESC));
  
  // Output SQL :
  echo db::cn()->compile( $f ); // Prints ("column1" + "column2" * 5), "column2", "column3" DESC
  
  // Usage with table fragment :
  $t = db::table('mytable', 'myalias');
  $f = db::orderby("($t->column1 + $t->column2 * 5)")->orderby($t->column2, array($t->column3, db::DESC));
  
  // Output SQL : 
  echo db::cn()->compile( $f );  
  
  // ("myalias"."column1" + "myalias"."column2" * 5), "myalias"."column2", "myalias"."column3" DESC
?>
{% endhighlight %}

<p>Note that the ordering specification can be included directly in the pseudo SQL string, though in this case it won't be possible to set it programmatically if need be :</p>

{% highlight php %}
<?php
  $f = db::orderby("($t->column1 + $t->column2 * 5)")->orderby($t->column2, "$t->column3 DESC");
?>
{% endhighlight %}


